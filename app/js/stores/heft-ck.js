define(["stores/ajax-queue"],function(e){var t={name:"heft",localStore:localStorage.getItem(this.name),initLocalStore:function(){this.localData||(this.localData=localStorage.getItem(this.name)&&JSON.parse(localStorage.getItem(this.name))||{});this.localData.notes||(this.localData.notes={})},saveNote:function(){localStorage.setItem(this.name,JSON.stringify(this.localData))},getLocalNote:function(e){this.localData.notes[e]&&this.trigger("gotNote",this.localData.notes[e])},getAllLocalNotes:function(){this.initLocalStore();var e=_.keys(this.localData.notes).sort(function(e,t){return e.modifydate-t.modifydate}),t={};_.each(e,function(e){t[e]=this.localData.notes[e]},this);this.localData.notes=t;_.each(_.keys(this.localData.notes),function(e){this.getLocalNote(e)},this)},saveLocalNote:function(e){this.initLocalStore();var t=this.localData.notes[e.key];if(!t)this.localData.notes[e.key]=e;else if(t!==e)if(!e.style&&t){var n=t.style;this.localData.notes[e.key]=e;this.localData.notes[e.key].style=n}else this.localData.notes[e.key]=e;this.saveNote()}};t.initLocalStore();return t});